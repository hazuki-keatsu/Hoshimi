# Phase 5: 工具化与发布 (Tooling & Publishing)

## 1. 阶段目标
完善引擎的资源管理机制，提供辅助开发的 Debug 工具，并构建发布流水线。

## 2. 核心任务拆解

### 5.1 资源分段与预测 (Segmentation & Prediction)
- [ ] **依赖图分析**
  - 基于路由表，分析每个章节引用的图片/音频资源。
  - 生成资源依赖图 (Dependency Graph)。
- [ ] **智能预加载 (Smart Preloading)**
  - 根据当前阅读位置，预测下一个可能跳转的章节，后台线程静默加载其资源。
  - **GC 策略**: 设定内存阈值，自动卸载 3 步之前的场景资源。

### 5.2 Debug Overlay
- [ ] **调试面板**
  - 实现一个置顶的 Debug UI (可以使用 `egui` 或自研 UI)。
  - 功能: 显示 FPS、显存占用、当前路由路径、Lua 变量监视器。
- [ ] **快速跳转**
  - 下拉菜单列出所有路由节点，点击直接跳转，方便测试。

### 5.3 打包与加密 (Packaging)
- [ ] **资源归档 (Archiver)**
  - 设计一种文件包格式 (如 `.hsp`), 将 assets 目录打包。
  - 支持 Zstd 压缩 与 AES 加密。
- [ ] **发布构建 (CI/CD)**
  - 编写 GitHub Actions 脚本，自动构建 Win/Mac/Linux 版本的 Release 包。

## 3. 技术难点与注意
- **异步加载**: 资源加载必须在后台线程进行，绝不能阻塞主渲染线程，否则会造成游戏卡顿。
- **跨平台路径**: 发布的包在不同 OS 上的路径分隔符问题，统一使用 `/` 规范化处理。
